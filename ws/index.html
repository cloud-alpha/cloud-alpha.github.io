<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Foundation Intranet</title>
  <style>
    body {
      background: #000;
      color: #00ff00;
      font-family: 'Fira Mono', 'Consolas', monospace;
      margin: 0;
      padding: 2rem;
      min-height: 100vh;
    }
    #console, #boot-sequence, #security-level-select {
      white-space: pre-wrap;
      font-size: 1.2rem;
      line-height: 1.5;
    }
    .console-link {
      color: #00ff00;
      text-decoration: none;
      border-bottom: 1px dashed #00ff00;
      transition: background 0.2s, color 0.2s;
      padding: 2px 4px;
      cursor: pointer;
      display: inline-block;
      margin-bottom: 0.5em;
    }
    .console-link:hover, .console-link:focus {
      background: #00ff00;
      color: #000;
      border-bottom: 1px solid #00ff00;
    }
    .prompt {
      color: #00ff00;
      margin-right: 8px;
      user-select: none;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin-bottom: 0.7em;
    }
    .cursor {
      display: inline-block;
      width: 10px;
      background: #00ff00;
      animation: blink 1s steps(1) infinite;
      vertical-align: bottom;
      height: 1em;
      margin-left: 2px;
    }
    .hidden {
      display: none;
    }
    #security-level-select {
      margin-top: 2em;
    }
    #command-line {
      margin-top: 2em;
      font-size: 1.2rem;
      color: #00ff00;
      font-family: inherit;
    }
    #cmd-history {
      margin-bottom: 0.5em;
      min-height: 2em;
    }
    #cmd-input {
      background: #000;
      color: #00ff00;
      border: none;
      font-family: inherit;
      font-size: 1.2rem;
      outline: none;
      width: 300px;
    }
    #cmd-label {
      margin-right: 8px;
      user-select: none;
    }
    #five-extra {
      margin-top: 2em;
      color: #00ff00;
    }
    .cmd-output {
      color: #00ff00;
    }
    .cmd-error {
      color: #ff3333;
    }
    .cmd-success {
      color: #33ff33;
    }
    .cmd-warning {
      color: #ffff33;
    }
    .cmd-table {
      border-collapse: collapse;
      margin-top: 0.5em;
      margin-bottom: 0.5em;
    }
    .cmd-table td, .cmd-table th {
      border: 1px dashed #00ff00;
      padding: 0.2em 0.7em;
    }
    .cmd-table th {
      background: #003300;
    }
    .cmd-table tr:nth-child(even) {
      background: #001a00;
    }
  </style>
</head>
<body>
  <div id="boot-sequence"></div>
  <div id="security-level-select" class="hidden">
    <div id="command-line">
      <div id="cmd-history"></div>
      <span id="cmd-label">&gt;</span>
      <input id="cmd-input" type="text" autocomplete="off" placeholder="Befehl eingeben..." />
    </div>
    <div id="cmd-error" style="color:#00ff00; margin-top:1em;"></div>
  </div>
  <div id="console" class="hidden">
    <div id="text"></div>
    <ul id="link-list"></ul>
    <div id="five-extra"></div>
  </div>
  <script>
    const bootLines = [
      "[ OK ] Initialisiere Foundation-Intranet...",
      "[ OK ] Lade Sicherheitsprotokolle...",
      "[ OK ] Überprüfe Benutzerberechtigungen...",
      "[ OK ] Verbinde mit Datenbank...",
      "[ OK ] Authentifizierung erfolgreich.",
      "[ OK ] Starte Benutzeroberfläche...",
      "",
      "Willkommen bei der SCP Foundation.",
      ""
    ];

    const textText = `Herzlich Willkommen im Foundation-Internen Intranet! Aktuell befinden Sie sich im Personalprofil von "[RS] Thomas Greenwood".`;

    const links = [
      { name: "Crosstestprotokoll SCP-035 x SCP-049-2", url: "https://docs.google.com/document/d/18B3t7HVVrUqNd__kgELkf1RV9tZswhmk_37WJQnb2fM/edit?tab=t.0", level: 3 },
      { name: "Geisterjagd", url: "https://docs.google.com/document/d/1_Kb08rcrifX9mi6CSAodPLyGX2F8L5R2J1ha14-FrDA/edit?usp=sharing", level: 3 },
      { name: "SCP Crosstestprotokoll SCP-939 x SCP-049", url: "https://docs.google.com/document/d/1YvKM6nzAX7j497fWMmen8a8_O5kRYk94_J7ZaGeMOVY/edit?usp=sharing", level: 3 },
      { name: "SCP-682 Beobachtungsprotokoll", url: "#", level: 4 },
      { name: "SCP-173 Wartungsplan", url: "#", level: 2 },
      { name: "SCP-999 Wohlfühlbericht", url: "#", level: 1 }
    ];

    const fiveText = `Durch Ihre erweiterte Sicherheitsfreigabe erlangen Sie zusätzlichen Zugriff auf noch nicht genehmigte Testreihen/Testprotokolle.`;

    const unchecked = [
      { name: "SCP-049-2 Testprotokoll", url: "https://docs.google.com/document/d/1YvKM6nzAX7j497fWMmen8a8_O5kRYk94_J7ZaGeMOVY/edit?usp=sharing"},
      { name: "SCP-682 x SCP-999 Experiment", url: "#" }
    ];

    // Für den "scan" Befehl
    const systemStatus = [
      { name: "Netzwerk", status: "OK" },
      { name: "Datenbank", status: "OK" },
      { name: "Sicherheitsprotokoll", status: "WARNUNG" },
      { name: "Benutzer-Authentifizierung", status: "OK" },
      { name: "SCP-Containment", status: "FEHLER" }
    ];

    let selectedLevel = null;

    const bootDiv = document.getElementById('boot-sequence');
    const consoleDiv = document.getElementById('console');
    const textDiv = document.getElementById('text');
    const linkList = document.getElementById('link-list');
    const levelDiv = document.getElementById('security-level-select');
    const fiveExtraDiv = document.getElementById('five-extra');
    const cmdInput = document.getElementById('cmd-input');
    const cmdError = document.getElementById('cmd-error');
    const cmdHistory = document.getElementById('cmd-history');
    let linkIndex = 0;

    function showBootSequence(i = 0) {
      if (i < bootLines.length) {
        bootDiv.innerHTML += bootLines[i] + '\n';
        setTimeout(() => showBootSequence(i + 1), 400);
      } else {
        setTimeout(() => {
          showSecurityLevelSelect();
        }, 600);
      }
    }

    function showSecurityLevelSelect() {
      bootDiv.classList.add('hidden');
      levelDiv.classList.remove('hidden');
      cmdInput.value = '';
      cmdInput.focus();
      cmdError.textContent = '';
      cmdHistory.innerHTML = '';
      printToCmdHistory('Geben Sie "help" für eine Liste verfügbarer Befehle ein.');
    }

    function printToCmdHistory(text, type = "output") {
      let cssClass = "cmd-output";
      if (type === "error") cssClass = "cmd-error";
      if (type === "success") cssClass = "cmd-success";
      if (type === "warning") cssClass = "cmd-warning";
      cmdHistory.innerHTML += `<span class="${cssClass}">${text}</span><br>`;
      cmdHistory.scrollTop = cmdHistory.scrollHeight;
    }

    // Listen for Enter key on command line
    cmdInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        const val = cmdInput.value.trim();
        if (!val) return;
        printToCmdHistory('&gt; ' + val, "output");
        handleCommand(val);
        cmdInput.value = '';
      }
    });

    function handleCommand(cmd) {
      cmdError.textContent = '';
      const args = cmd.split(' ');
      const main = args[0].toLowerCase();

      if (main === 'help') {
        printToCmdHistory(
          'Verfügbare Befehle:<br>' +
          '<b>setlevel [1-5]</b> - Sicherheitslevel setzen<br>' +
          '<b>echo [Text]</b> - Text ausgeben<br>' +
          '<b>clear</b> - Verlauf löschen<br>' +
          '<b>scan</b> - Systemstatus anzeigen<br>' +
          '<b>whoami</b> - Benutzerinfo anzeigen<br>' +
          '<b>motd</b> - Nachricht des Tages<br>' +
          '<b>links</b> - Zeigt verfügbare Dokumente<br>' +
          '<b>exit</b> - Sitzung beenden<br>' +
          '<b>help</b> - Hilfe anzeigen'
        );
      } else if (main === 'setlevel') {
        if (args.length === 2 && /^[1-5]$/.test(args[1])) {
          printToCmdHistory(`Sicherheitslevel auf ${args[1]} gesetzt.`, "success");
          selectLevel(parseInt(args[1]));
        } else {
          printToCmdHistory('Benutzung: setlevel [1-5]', "error");
        }
      } else if (main === 'echo') {
        printToCmdHistory(args.slice(1).join(' '));
      } else if (main === 'clear') {
        cmdHistory.innerHTML = '';
      } else if (main === 'scan') {
        let table = '<table class="cmd-table"><tr><th>System</th><th>Status</th></tr>';
        systemStatus.forEach(s => {
          let statusClass = s.status === "OK" ? "cmd-success" : (s.status === "WARNUNG" ? "cmd-warning" : "cmd-error");
          table += `<tr><td>${s.name}</td><td class="${statusClass}">${s.status}</td></tr>`;
        });
        table += '</table>';
        printToCmdHistory(table);
      } else if (main === 'whoami') {
        printToCmdHistory('Benutzer: [RS] Thomas Greenwood<br>Rolle: Forscher<br>Standort: Site-19<br>Sicherheitslevel: ' + (selectedLevel || 'Nicht gesetzt'));
      } else if (main === 'motd') {
        printToCmdHistory('Nachricht des Tages: "Bleiben Sie wachsam. Sicherheit geht vor."');
      } else if (main === 'links') {
        let out = '';
        const allowedLinks = links.filter(l => selectedLevel && l.level <= selectedLevel);
        if (!selectedLevel) {
          out = 'Bitte setzen Sie zuerst Ihr Sicherheitslevel mit "setlevel [1-5]".';
        } else if (allowedLinks.length === 0) {
          out = 'Keine Dokumente für Ihr Sicherheitslevel verfügbar.';
        } else {
          out = 'Verfügbare Dokumente:<br>';
          allowedLinks.forEach(l => {
            out += `<span class="prompt">&gt;</span> <a class="console-link" href="${l.url}" target="_blank">${l.name}</a><br>`;
          });
          if (selectedLevel === 5) {
            out += `<br>${fiveText}<br>`;
            out += 'Nicht genehmigte Testprotokolle:<br>';
            unchecked.forEach(u => {
              out += `<span class="prompt">&gt;</span> <a class="console-link" href="${u.url}" target="_blank">${u.name}</a><br>`;
            });
          }
        }
        printToCmdHistory(out);
      } else if (main === 'exit') {
        printToCmdHistory('Sitzung beendet. Sie können das Fenster schließen.', "warning");
        cmdInput.disabled = true;
      } else {
        printToCmdHistory('Unbekannter Befehl. Geben Sie "help" ein für Hilfe.', "error");
      }
    }

    function selectLevel(level) {
      selectedLevel = level;
      setTimeout(() => {
        levelDiv.classList.add('hidden');
        consoleDiv.classList.remove('hidden');
        typetext();
      }, 600);
    }

    function typetext(i = 0) {
      textDiv.innerHTML = textText.slice(0, i) + '<span class="cursor"></span>';
      if (i < textText.length) {
        setTimeout(() => typetext(i + 1), 20);
      } else {
        textDiv.innerHTML = textText;
        setTimeout(typeAllLinks, 400);
      }
    }

    function typeLink(link, callback) {
      const li = document.createElement('li');
      const prompt = document.createElement('span');
      prompt.className = 'prompt';
      prompt.textContent = '>';
      li.appendChild(prompt);

      const a = document.createElement('a');
      a.className = 'console-link';
      a.href = link.url;
      a.target = '_blank';
      a.rel = 'noopener';
      a.tabIndex = -1;

      li.appendChild(a);
      linkList.appendChild(li);

      let i = 0;
      function typeChar() {
        a.innerHTML = link.name.slice(0, i) + '<span class="cursor"></span>';
        if (i < link.name.length) {
          i++;
          setTimeout(typeChar, 50);
        } else {
          a.innerHTML = link.name;
          a.tabIndex = 0;
          if (callback) setTimeout(callback, 200);
        }
      }
      typeChar();
    }

    function typeUncheckedLink(link, callback) {
      const div = document.createElement('div');
      const prompt = document.createElement('span');
      prompt.className = 'prompt';
      prompt.textContent = '>';
      div.appendChild(prompt);

      const a = document.createElement('a');
      a.className = 'console-link';
      a.href = link.url;
      a.target = '_blank';
      a.rel = 'noopener';
      a.tabIndex = -1;

      div.appendChild(a);
      fiveExtraDiv.appendChild(div);

      let i = 0;
      function typeChar() {
        a.innerHTML = link.name.slice(0, i) + '<span class="cursor"></span>';
        if (i < link.name.length) {
          i++;
          setTimeout(typeChar, 50);
        } else {
          a.innerHTML = link.name;
          a.tabIndex = 0;
          if (callback) setTimeout(callback, 200);
        }
      }
      typeChar();
    }

    function typeAllLinks() {
      const allowedLinks = links.filter(l => l.level <= selectedLevel);
      linkList.innerHTML = '';
      fiveExtraDiv.innerHTML = '';
      linkIndex = 0;
      function next() {
        if (linkIndex < allowedLinks.length) {
          typeLink(allowedLinks[linkIndex], () => {
            linkIndex++;
            next();
          });
        } else if (allowedLinks.length === 0) {
          const li = document.createElement('li');
          li.textContent = 'Keine Dokumente für Ihr Sicherheitslevel verfügbar.';
          linkList.appendChild(li);
          if (selectedLevel === 5) {
            setTimeout(typeFiveExtra, 400);
          }
        } else if (selectedLevel === 5) {
          setTimeout(typeFiveExtra, 400);
        }
      }
      next();
    }

    function typeFiveExtra() {
      let i = 0;
      function typeFiveText() {
        fiveExtraDiv.innerHTML = fiveText.slice(0, i) + '<span class="cursor"></span>';
        if (i < fiveText.length) {
          i++;
          setTimeout(typeFiveText, 20);
        } else {
          fiveExtraDiv.innerHTML = fiveText;
          setTimeout(typeAllUnchecked, 400);
        }
      }
      typeFiveText();
    }

    function typeAllUnchecked() {
      if (unchecked.length === 0) return;
      const heading = document.createElement('div');
      heading.style.marginTop = '1em';
      heading.textContent = "Nicht genehmigte Testprotokolle:";
      fiveExtraDiv.appendChild(heading);

      let idx = 0;
      function nextUnchecked() {
        if (idx < unchecked.length) {
          typeUncheckedLink(unchecked[idx], () => {
            idx++;
            nextUnchecked();
          });
        }
      }
      nextUnchecked();
    }

    showBootSequence();
  </script>
</body>
</html>